<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="UTF-8">
	<title>Sophie Bluel - Architecte d'intérieur</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=Work+Sans&display=swap" rel="stylesheet">
	<meta name="description" content="">
	<link rel="stylesheet" href="./assets/style.css">
	<style>
		.filter-buttons {
			display: flex;
			justify-content: center;
			gap: 10px;
			margin-bottom: 20px;
		}
		.filter-button {
			padding: 10px 20px;
			border: 1px solid #1D6154;
			border-radius: 60px;
			
			font-family: 'Syne';
			font-weight: 700;
			color: #1D6154;
			background-color: white;
			cursor: pointer;
			transition: all 0.3s ease;
		}
		.filter-button.active {
			background-color: #1D6154;
			color: white;
		}
	</style>
</head>
<body>
<header>
	<h1>Sophie Bluel <span>Architecte d'intérieur</span></h1>
	<nav>
		<ul>
			<li>projets</li>
			<li>contact</li>
			<li>login</li>
			<li><img src="./assets/icons/instagram.png" alt="Instagram"></li>
		</ul>
	</nav>
</header>
<main>
	<section id="introduction">
		<figure>
			<img src="./assets/images/sophie-bluel.png" alt="">
		</figure>
		<article>
			<h2>Designer d'espace</h2>
			<p>Je raconte votre histoire, je valorise vos idées. Je vous accompagne de la conception à la livraison finale du chantier.</p>
			<p>Chaque projet sera étudié en commun, de façon à mettre en valeur les volumes, les matières et les couleurs dans le respect de l'esprit des lieux et le choix adapté des matériaux. Le suivi du chantier sera assuré dans le souci du détail, le respect du planning et du budget.</p>
			<p>En cas de besoin, une équipe pluridisciplinaire peut-être constituée : architecte DPLG, décorateur(trice)</p>
		</article>
	</section>
	<section id="portfolio">
		<h2>Mes Projets</h2>
		<div class="filter-buttons">
			<!-- Les boutons de filtrage seront insérés ici dynamiquement -->
		</div>
		<div class="gallery">
			<!-- Les projets seront insérés ici dynamiquement -->
		</div>
	</section>
	<section id="contact">
		<h2>Contact</h2>
		<p>Vous avez un projet ? Discutons-en !</p>
		<form action="#" method="post">
			<label for="name">Nom</label>
			<input type="text" name="name" id="name">
			<label for="email">Email</label>
			<input type="email" name="email" id="email">
			<label for="message">Message</label>
			<textarea name="message" id="message" cols="30" rows="10"></textarea>
			<input type="submit" value="Envoyer">
		</form>
	</section>
</main>

<footer>
	<nav>
		<ul>
			<li>Mentions Légales</li>
		</ul>
	</nav>
</footer>

<script>
	let allWorks = [];

	// Fonction pour récupérer les works depuis l'API
	async function fetchWorks() {
		try {
			const response = await fetch('http://localhost:5678/api/works');
			if (!response.ok) {
				throw new Error(`HTTP error! status: ${response.status}`);
			}
			allWorks = await response.json();
			return allWorks;
		} catch (error) {
			console.error("Impossible de récupérer les works:", error);
			return [];
		}
	}

	// Fonction pour récupérer les catégories depuis l'API
	async function fetchCategories() {
		try {
			const response = await fetch('http://localhost:5678/api/categories');
			if (!response.ok) {
				throw new Error(`HTTP error! status: ${response.status}`);
			}
			return await response.json();
		} catch (error) {
			console.error("Impossible de récupérer les catégories:", error);
			return [];
		}
	}

	// Fonction pour créer un élément de galerie
	function createGalleryItem(work) {
		const figure = document.createElement('figure');
		const img = document.createElement('img');
		img.src = work.imageUrl;
		img.alt = work.title;
		const figcaption = document.createElement('figcaption');
		figcaption.textContent = work.title;
		figure.appendChild(img);
		figure.appendChild(figcaption);
		return figure;
	}

	// Fonction pour afficher les works dans la galerie
	function displayWorks(works) {
		const gallery = document.querySelector('.gallery');
		gallery.innerHTML = ''; // Vider la galerie existante
		works.forEach(work => {
			const galleryItem = createGalleryItem(work);
			gallery.appendChild(galleryItem);
		});
	}

	// Fonction pour créer les boutons de filtrage
	function createFilterButtons(categories) {
		const filterContainer = document.querySelector('.filter-buttons');
		filterContainer.innerHTML = ''; // Vider le conteneur existant

		// Ajouter le bouton "Tous"
		const allButton = document.createElement('button');
		allButton.textContent = 'Tous';
		allButton.classList.add('filter-button', 'active');
		allButton.dataset.categoryId = 'all';
		filterContainer.appendChild(allButton);

		// Ajouter les boutons pour chaque catégorie
		categories.forEach(category => {
			const button = document.createElement('button');
			button.textContent = category.name;
			button.classList.add('filter-button');
			button.dataset.categoryId = category.id;
			filterContainer.appendChild(button);
		});

		// Ajouter les écouteurs d'événements pour le filtrage
		filterContainer.addEventListener('click', filterWorks);
	}

	// Fonction pour filtrer les works
	function filterWorks(event) {
		if (event.target.classList.contains('filter-button')) {
			// Mettre à jour l'état actif des boutons
			document.querySelectorAll('.filter-button').forEach(btn => btn.classList.remove('active'));
			event.target.classList.add('active');

			const categoryId = event.target.dataset.categoryId;
			let filteredWorks;

			if (categoryId === 'all') {
				filteredWorks = allWorks;
			} else {
				filteredWorks = allWorks.filter(work => work.categoryId == categoryId);
			}

			displayWorks(filteredWorks);
		}
	}

	// Fonction principale
	async function initGallery() {
		allWorks = await fetchWorks();
		const categories = await fetchCategories();
		createFilterButtons(categories);
		displayWorks(allWorks);
	}

	// Exécuter la fonction principale au chargement de la page
	document.addEventListener('DOMContentLoaded', initGallery);
</script>
</body>
</html>